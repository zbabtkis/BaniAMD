var Bani=function(){var a=function(b){var c=new a.util.EventEmitter;this.appEmitter=new a.util.EventEmitter,this.__addClass=function(a,b){if(c[a])throw new Error("Class of name "+a+" already exists");c[a]=b,c.publish("ready:"+a)},this.__build=function(a){var b,d=this,e={},f=c[a],g=function(){for(var a in f)"__construct"!==a&&(this[a]=f[a].value);f&&f.__construct&&f.__construct.value.apply(this)};f&&f.__extender&&(b=d.__build(f.__extender),g.prototype=b.private,e=b.public);var h=new g;for(var i in f)"__construct"!==i&&h.hasOwnProperty(i)&&"public"===f[i].rule&&(e[i]=h[i]);return{"private":h,"public":e}},this.use=function(a){var b=this;return function(){var c=b.__build(a);return c.public}},this.__loadReqs=function(){var a=0,b=0,d=this;for(var e in c){var f=c[e];f.__extender&&!c[f.__extender]&&(this.import(f.__extender),b++,c.subscribe("ready:"+f.__extender,function(){a++,a===b&&d.appEmitter.publish("ready")}))}0===b&&d.appEmitter.publish("ready")},b&&"function"==typeof b.main&&(this.__main=b.main),this.augment(b)};return a.util={log:function(a,b){console.log(b)},is:function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},isArray:function(a){return this.is("Array",a)},isFunction:function(a){return this.is("Function",a)},isObject:function(a){return this.is("Object",a)},isString:function(a){return this.is("String",a)}},a.util.EventEmitter=function(){},a.util.EventEmitter.prototype.Events={},a.util.EventEmitter.prototype.__callbacks=function(a){return this.Events[a]=this.Events[a]||[]},a.util.EventEmitter.prototype.subscribe=function(a,b){var c=this.__callbacks(a);c.push(b)},a.util.EventEmitter.prototype.publish=function(a,b){var c,d=this.__callbacks(a);for(var e in d)c=d[e],c.call(this,b)},a.prototype.augment=function(a){var b=this,c=/^(public|private|protected)\s(.*?)$/i,d=/^class\s(.*?)($|\sextends\s(.*?)$)/i,e="",f=function(e,f){var g,h,i=e.match(d),j=a[e],k={};g=i&&i[1]?i[1]:e,i&&i[3]&&(k.__extender=i[3]);for(var l in j)j.hasOwnProperty(l)&&(h=l.match(c),k[h[2]]={rule:h[1],value:j[l]});g=f?f+"."+g:g,k.__class__={rule:"private",value:g},b.__addClass(g,k)};for(var g in a)"namespace"!==g?f(g,e):e=a.namespace},a.prototype.run=function(){var b=this;this.appEmitter.subscribe("ready",function(){b.__main?b.__main():a.util.log("warn","Application has no main function")}),this.__loadReqs()},a.prototype.__autoload=function(a){var b=a.split(".");return b.pop(),a=b.join("."),a.replace(/\./,"/")},a.prototype.import=function(a){var a=this.__autoload(a),b=document.createElement("script"),c=document.getElementsByTagName("head").item();b.src=a+".js",b.async=!1,c.appendChild(b)},a}();