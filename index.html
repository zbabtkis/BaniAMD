<!DOCTYPE html>

<html>
<head>
    <link rel='stylesheet' href='http://code.jquery.com/qunit/qunit-1.12.0.css' />
    <script src='http://code.jquery.com/qunit/qunit-1.12.0.js'></script>
    <script src='bani.js'></script>
</head>
<body>
    <div id="qunit"></div>
    <div id="qunit-fixture"></div>

    <div id='app'>
    </div>
    
    <script>
    var app = new Bani({
	    'main': function() {
	        var Controller = this.use('Controller');

	        var AppController = new Controller();
	    },

	    'class Controller': {
	    	'public __construct': function() {
	    		var Model = app.use('Model.Person');
	    		var View = app.use('View.Person');
                var Region = app.use('Region');

	    		var model = new Model();
                
                var r1 = new Region();
                var r2 = new Region();

	    		model.set({
	    			name: 'Zack',
	    			age: 23
	    		});

	    		this.view = new View();

	    		this.view.render();
                
                this.registerRegion(r1);
                this.registerRegion(r2);
	    	},
            'public registerRegion': function(region) {
                if(this.view) {
                    console.log(region.el);
                    this.view.addRegion(region.el);
                }
            }
	    },

	    'class Model': {
	    	'private attributes': {},
	    	'private defaults': {},

	    	'public __construct': function() {
	    		for(var i in this.defaults) {
	    			this.set(i, this.defaults[i]);
	    		}
	    	},

	    	'public set': function(attrs, value) {
	    		if(Bani.util.isObject(attrs)) {
	    			for(var i in attrs) {
		    			this.attributes[i] = attrs[i];
		    		}
	    		} else {
	    			this.attributes[attrs] = value;
	    		}
	    	},

	    	'public get': function(attr) {
	    		return this.attributes[attr];
	    	},
	    	'public toJSON': function() {
	    		return Bani.util.clone(this.attributes);
	    	}
	    },

	    'class Model.Person extends Model': {
	    	'private defaults': {
	    		'name': "Alfred"
	    	}
	    },

	    'class View': {
	    	'public el': '#app',

	    	'public __construct': function() {
                this.viewport = Bani.util.clone(this.el);
                
                if(Bani.util.isString(this.el)) {
                    switch(this.el[0]) {
                        case '#':
                            this.el = this.el.replace(/#/, '');
                            this.el = document.getElementById(this.el);
                            break;
                        case '.':
                            this.el = this.el.replace(/\./, '');
                            this.el = document.getElementsByClassName(this.el);
                            break;
                        default:
                            this.el = document.getElementsByTagName(this.el);
                    }
                }
                console.log(this.el);
	    	},
            
            'public addRegion': function(region) {
                this.el.appendChild(region);
            },

	    	'public render': function(model) {
	    		this.el.innerHTML = this.html;
	    	}
	    },
        
        'class Region extends View': {
            'public __construct': function() {
                this.el = document.createElement('div');
                console.log(this.el);
            }
        },

	    'class View.Person extends View': {
	    	'private html': 'Hello, my name is: Zack'
	    }
	});

	app.run();
	</script>
</body>
</html>